<!DOCTYPE html>
<html lang="en">
<head>
  <header>
  <img src="hamza.png" alt="Hamza">
  <link rel="icon" href="./hamza.png?v=2" type="image/png" sizes="32x32" />
  <link rel="shortcut icon" href="./favicon.ico" type="image/x-icon" />
  <link rel="apple-touch-icon" href="./hamza.png" />
</header>
<div id="cursorStar" class="cursor-star"></div>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vote for Class Representative</title>
<style>
  body {
  font-family: Arial, sans-serif;
  text-align: center;
  background: linear-gradient(135deg, #74b9ff, #a29bfe, #55efc4);
  background-size: 600% 600%;
  animation: bgShift 15s infinite alternate;
  margin: 0;
  padding: 0;
}
@keyframes bgShift {
  0% { background-position: 0% 50%; }
  100% { background-position: 100% 50%; }
}
header {
  padding: 20px;
}
header img {
  width: 120px;
  height: 120px;
  border-radius: 50%;
  box-shadow: 0 0 20px 5px rgba(0, 255, 200, 0.7);
  animation: glow 2s infinite alternate;
}
@keyframes glow {
  from { box-shadow: 0 0 10px rgba(0, 255, 200, 0.6); }
  to { box-shadow: 0 0 25px rgba(0, 200, 255, 1); }
}
.candidate-btn {
  display: inline-block;
  margin: 10px;
  padding: 12px 20px;
  border: none;
  border-radius: 10px;
  background: #2ecc71;
  color: white;
  cursor: pointer;
  transition: all 0.3s ease;
  font-size: 16px;
}
.candidate-btn:hover {
  background: #27ae60;
  transform: scale(1.15);
}
.popup {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: white;
  border-radius: 15px;
  box-shadow: 0 0 25px rgba(0,0,0,0.3);
  padding: 30px;
  display: none;
  z-index: 1000;
  animation: pop 0.4s ease;
}
@keyframes pop {
  from { transform: translate(-50%, -50%) scale(0.5); opacity: 0; }
  to { transform: translate(-50%, -50%) scale(1); opacity: 1; }
}
.popup button {
  margin-top: 15px;
  padding: 8px 16px;
  border: none;
  border-radius: 8px;
  background: #00b894;
  color: white;
  cursor: pointer;
}
.popup button:hover {
  background: #0984e3;
}
#confetti {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 999;
}

  body { 
    font-family: Arial, sans-serif; 
    text-align: center; 
    margin-top: 40px; 
    cursor: default; 
    overflow-x: hidden; 
    background: linear-gradient(270deg, #ff7675, #74b9ff, #55efc4, #ffeaa7, #fd79a8);
    background-size: 1200% 1200%;
    animation: bgSwitch 18s ease infinite;
  }
@keyframes bgSwitch {
  0% {background-position: 0% 50%;}
  25% {background-position: 50% 100%;}
  50% {background-position: 100% 50%;}
  75% {background-position: 50% 0%;}
  100% {background-position: 0% 50%;}
}
h1 { color: green; }
button { margin: 6px; padding: 10px 20px; cursor: pointer; border-radius: 6px; border: none; }
.year-btn { background: lightgreen; }
.candidate-btn { background: darkgreen; color: white; margin: 5px; padding: 10px; border-radius: 5px; }
.hidden { display: none; }
table { width: 70%; margin: 20px auto; border-collapse: collapse; }
table, th, td { border: 1px solid #333; padding: 8px; }
.class-header { background: lightgreen; }
input, select { padding: 6px; margin: 5px; }
.admin-section { border: 2px solid green; padding: 15px; margin: 15px; background: #fff; border-radius: 8px; }
.remove-btn { margin-left: 8px; background: red; color: white; padding: 3px 6px; border-radius: 4px; cursor: pointer; }
.reset-btn { background: crimson; color: white; }
.selected-candidate { background: gold !important; color: black !important; font-weight: bold; }
#clock { font-size: 22px; font-weight: bold; color: orange; margin-bottom: 12px; font-family: 'Courier New', monospace; text-shadow: 1px 1px 2px green; }
#winnerPopup, #funPopup {
  position: fixed; top: 0; left: 0; width: 100%; height: 100%;
  background: rgba(0,0,0,0.6); display: flex; justify-content: center; align-items: center; z-index: 9999;
}
#winnerPopup.hidden, #funPopup.hidden { display: none; }
#winnerContent, #funContent {
  background: white; padding: 20px 30px; border-radius: 14px;
  font-size: 20px; font-weight: bold; color: green;
  text-align: center; box-shadow: 0 0 18px orange;
}
#winnerPopup button, #funPopup button {
  margin-top: 14px; padding: 8px 16px; background: orange; color: white; border: none; border-radius: 8px; cursor: pointer;
}
#winnerGif { width: 260px; max-width: 90%; margin-top: 12px; border-radius: 10px; display: block; margin-left: auto; margin-right: auto; }
.ball { position: fixed; top: -10px; width: 16px; height: 16px; border-radius: 50%; animation: fall linear forwards; z-index: 9998; }
@keyframes fall { 0% { transform: translateY(-10vh) } 100% { transform: translateY(120vh) } }
</style>
</head>
<body>

<div id="clock"></div>
<h1>Ethos International School Voting</h1>

<audio id="popSound" src="https://actions.google.com/sounds/v1/cartoon/pop.ogg" preload="auto"></audio>

<div class="admin-section">
    <h2>Admin: Add/Remove Candidates</h2>
    <input type="password" id="adminPassword" placeholder="Enter Admin Password" />
    <button onclick="loginAdmin()">Login</button>

    <div id="adminControls" class="hidden">
        <select id="yearSelect">
            <option value="Y4">Year 4</option>
            <option value="Y5">Year 5</option>
            <option value="Y6">Year 6</option>
            <option value="Y7">Year 7</option>
            <option value="Y8">Year 8</option>
            <option value="Y9">Year 9</option>
            <option value="Y10">Year 10</option>
            <option value="Y11">Year 11</option>
        </select>
        <input type="text" id="candidateName" placeholder="Candidate Name" />
        <button onclick="addCandidate()">Add Candidate</button>
        <h3>Current Candidates</h3>
        <div id="candidateList"></div>
    </div>
</div>

<div>
    <h2>Vote for Your Class Representative</h2>
    <label>Choose The Year Group: 
        <select id="studentYear">
            <option value="Y4">Year 4</option>
            <option value="Y5">Year 5</option>
            <option value="Y6">Year 6</option>
            <option value="Y7">Year 7</option>
            <option value="Y8">Year 8</option>
            <option value="Y9">Year 9</option>
            <option value="Y10">Year 10</option>
            <option value="Y11">Year 11</option>
        </select>
    </label>
    <br>
    <button onclick="showCandidates()">Show Candidates</button>
</div>

<div id="candidateButtons" class="hidden">
    <h3>Select Your nominee</h3>
    <div id="candidates"></div>
</div>

<button id="castVoteBtn" class="hidden" onclick="castVote()">Submit Vote</button>
<p>Total Votes: <span id="totalVotes">0</span></p>

<div>
    <h2>Voting Results</h2>
    <button onclick="requestPassword()">View Results</button>
    <button onclick="hideResults()">Hide Results</button>
    <button id="finishBtn" onclick="finishVoting()">Finish</button>
    <button class="reset-btn" onclick="resetResults()">Reset Results</button>
    <div id="dataTable" class="hidden"></div>
</div>

<div id="winnerPopup" class="hidden">
  <div id="winnerContent"></div>
  <img id="winnerGif" src="" alt="Funny GIF">
  <button onclick="closeWinnerPopup()">Close</button>
</div>

<!-- Fun Popup -->
<div id="funPopup" class="hidden">
  <div id="funContent"></div>
  <button onclick="closeFunPopup()">OK</button>
</div>

<script>
let totalVotes = 0;
let votesData = [];
let candidatesByYear = JSON.parse(localStorage.getItem('candidatesByYear')) || {Y4:[],Y5:[],Y6:[],Y7:[],Y8:[],Y9:[],Y10:[],Y11:[]};
let selectedCandidate = '';
let currentYear = '';
const resultsPassword = "Ethos@123";
const adminPassword = "Ethos@123";

function showFunPopup(msg){
  document.getElementById('funContent').textContent = msg;
  document.getElementById('funPopup').classList.remove('hidden');
}
function closeFunPopup(){
  document.getElementById('funPopup').classList.add('hidden');
}

function loginAdmin(){
  const e=document.getElementById('adminPassword').value;
  if(e===adminPassword){
    document.getElementById('adminControls').classList.remove('hidden');
    showFunPopup("‚úÖ Admin access granted!");
  }else{
    showFunPopup("‚ùå Incorrect admin password!");
  }
}
function addCandidate(){
  const y=document.getElementById('yearSelect').value;
  const n=document.getElementById('candidateName').value.trim();
  if(!n){showFunPopup("‚ö†Ô∏è Enter a name");return;}
  candidatesByYear[y].push(n);
  localStorage.setItem('candidatesByYear',JSON.stringify(candidatesByYear));
  document.getElementById('candidateName').value='';
  renderCandidateList();
  showFunPopup(`üéâ Candidate ${n} added to ${y}`);
}
function removeCandidate(y,n){
  candidatesByYear[y]=candidatesByYear[y].filter(c=>c!==n);
  localStorage.setItem('candidatesByYear',JSON.stringify(candidatesByYear));
  renderCandidateList();
  showFunPopup(`üóëÔ∏è Candidate ${n} removed from ${y}`);
}
function renderCandidateList(){
  const c=document.getElementById('candidateList');c.innerHTML='';
  for(const y in candidatesByYear){
    if(candidatesByYear[y].length){
      const d=document.createElement('div');
      d.innerHTML=`<b>${y}:</b> `;
      candidatesByYear[y].forEach(cd=>{
        const s=document.createElement('span');s.textContent=cd;
        const b=document.createElement('button');b.textContent="‚ùå";b.className="remove-btn";b.onclick=()=>removeCandidate(y,cd);
        d.appendChild(s);d.appendChild(b);d.appendChild(document.createTextNode(" "));
      });
      c.appendChild(d)
    }
  }
}
function showCandidates(){
  currentYear=document.getElementById('studentYear').value;
  const l=candidatesByYear[currentYear];
  if(!l.length){showFunPopup("‚ö†Ô∏è No candidates for this year yet.");return;}
  const c=document.getElementById('candidates');c.innerHTML='';
  l.forEach(cd=>{
    const b=document.createElement('button');
    b.className='candidate-btn';b.textContent=cd;
    b.onclick=()=>selectCandidate(cd,b);
    c.appendChild(b)
  });
  document.getElementById('candidateButtons').classList.remove('hidden')
}
function selectCandidate(n,b){
  selectedCandidate=n;
  document.querySelectorAll('.candidate-btn').forEach(btn=>btn.classList.remove('selected-candidate'));
  b.classList.add('selected-candidate');
  document.getElementById('castVoteBtn').classList.remove('hidden')
}
function castVote(){
  if(!selectedCandidate){showFunPopup("‚ö†Ô∏è Select a candidate");return;}
  totalVotes++;
  document.getElementById('totalVotes').textContent=totalVotes;
  document.getElementById('popSound').play();
  const e=votesData.find(v=>v.candidate===selectedCandidate&&v.year===currentYear);
  if(e){e.count++;}else{votesData.push({year:currentYear,candidate:selectedCandidate,count:1});}
  localStorage.setItem('votesData',JSON.stringify(votesData));
  localStorage.setItem('totalVotes',totalVotes);
  selectedCandidate='';
  document.getElementById('castVoteBtn').classList.add('hidden');
  document.querySelectorAll('.candidate-btn').forEach(btn=>btn.classList.remove('selected-candidate'));
  showFunPopup("üéâ Vote submitted!");
}
function requestPassword(){
  const e=prompt("Enter password to view results:");
  if(e===resultsPassword){document.getElementById('dataTable').classList.remove('hidden');displayData()}
  else{showFunPopup("‚ùå Incorrect password!")}
}
function hideResults(){document.getElementById('dataTable').classList.add('hidden')}
function displayData(){
  const c=document.getElementById('dataTable');c.innerHTML='';
  const d=JSON.parse(localStorage.getItem('votesData'))||votesData;
  for(const y in candidatesByYear){
    const t=document.createElement('table');
    const h=`<tr class="class-header"><th>${y}</th><th>Candidate</th><th>Votes</th></tr>`;
    t.innerHTML=h;
    let max=0;
    candidatesByYear[y].forEach(n=>{
      const r=d.find(v=>v.candidate===n&&v.year===y);
      const v=r?r.count:0;
      if(v>max)max=v
    });
    candidatesByYear[y].forEach(n=>{
      const r=d.find(v=>v.candidate===n&&v.year===y);
      const v=r?r.count:0;
      let row=`<tr><td>${y}</td><td>${n}</td><td>${v}</td></tr>`;
      t.innerHTML+=row
    });
    c.appendChild(t)
  }
}
function resetResults(){
  const e=prompt("Enter password to reset results:");
  if(e===resultsPassword){
    localStorage.removeItem('votesData');
    localStorage.removeItem('totalVotes');
    votesData=[];totalVotes=0;
    document.getElementById('totalVotes').textContent=totalVotes;
    document.getElementById('dataTable').innerHTML='';
    showFunPopup("‚ôªÔ∏è All voting results reset!");
  }else{showFunPopup("‚ùå Incorrect password! Reset denied.")}
}
window.onload=()=>{votesData=JSON.parse(localStorage.getItem('votesData'))||[];totalVotes=parseInt(localStorage.getItem('totalVotes'))||0;document.getElementById('totalVotes').textContent=totalVotes;renderCandidateList();updateClock()}
function updateClock(){const now=new Date();const h=String(now.getHours()).padStart(2,'0');const m=String(now.getMinutes()).padStart(2,'0');const s=String(now.getSeconds()).padStart(2,'0');document.getElementById('clock').textContent=`${h}:${m}:${s}`}
setInterval(updateClock,1000)

function finishVoting(){
  const d=JSON.parse(localStorage.getItem('votesData'))||votesData;
  const totals={};for(const y in candidatesByYear){candidatesByYear[y].forEach(n=>{totals[n]=0})}
  d.forEach(v=>{totals[v.candidate]=(totals[v.candidate]||0)+v.count});
  let max=0;for(const n in totals){if(totals[n]>max)max=totals[n]}
  if(max===0){document.getElementById('winnerContent').textContent='No votes yet';document.getElementById('winnerGif').src='https://media.giphy.com/media/3o6ZsX2d4vYpVZ9Qxq/giphy.gif';document.getElementById('winnerPopup').classList.remove('hidden');return}
  const winners=Object.keys(totals).filter(n=>totals[n]===max);
  const winnerName=winners[Math.floor(Math.random()*winners.length)];
  const gifs=['https://media.giphy.com/media/l0MYt5jPR6QX5pnqM/giphy.gif','https://media.giphy.com/media/3o6Zt481isNVuQI1l6/giphy.gif','https://media.giphy.com/media/3o7aCTfyhYawdOXcFW/giphy.gif','https://media.giphy.com/media/5GoVLqeAOo6PK/giphy.gif'];
  const gif=gifs[Math.floor(Math.random()*gifs.length)];
  document.getElementById('winnerContent').textContent=`üèÜ Winner: ${winnerName} (${max} votes) üèÜ`;
  document.getElementById('winnerGif').src=gif;
  document.getElementById('winnerPopup').classList.remove('hidden');
  bigConfetti()
}
function closeWinnerPopup(){document.getElementById('winnerPopup').classList.add('hidden')}
function spawnBall(xColor){const b=document.createElement('div');b.className='ball';b.style.left=Math.random()*100+'vw';b.style.background=xColor;b.style.animationDuration=(6+Math.random()*5)+'s';document.body.appendChild(b);setTimeout(()=>b.remove(),12000)}
function bigConfetti(){for(let i=0;i<80;i++)setTimeout(()=>spawnBall(`hsl(${Math.random()*360},70%,55%)`),i*80)}
function showPopup(message) {
  document.getElementById("popup-message").textContent = message;
  document.getElementById("popup").style.display = "block";
  startConfetti();
  setTimeout(stopConfetti, 2000);
}
function closePopup() {
  document.getElementById("popup").style.display = "none";
}

const confettiCanvas = document.getElementById("confetti");
const ctx = confettiCanvas.getContext("2d");
confettiCanvas.width = window.innerWidth;
confettiCanvas.height = window.innerHeight;

let confettiPieces = [];

function createConfetti() {
  return {
    x: Math.random() * confettiCanvas.width,
    y: Math.random() * confettiCanvas.height - confettiCanvas.height,
    color: `hsl(${Math.random() * 360}, 100%, 50%)`,
    size: Math.random() * 8 + 2,
    speed: Math.random() * 3 + 2,
  };
}

function drawConfetti() {
  ctx.clearRect(0, 0, confettiCanvas.width, confettiCanvas.height);
  confettiPieces.forEach((p, i) => {
    ctx.fillStyle = p.color;
    ctx.fillRect(p.x, p.y, p.size, p.size);
    p.y += p.speed;
    if (p.y > confettiCanvas.height) confettiPieces[i] = createConfetti();
  });
}

let confettiInterval;

function startConfetti() {
  confettiPieces = Array.from({ length: 150 }, createConfetti);
  confettiInterval = setInterval(drawConfetti, 20);
}

function stopConfetti() {
  clearInterval(confettiInterval);
  ctx.clearRect(0, 0, confettiCanvas.width, confettiCanvas.height);
}

</script>

<link rel="icon" type="image/png" href="hamza.png">
</body>
</html>
